<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="../static/images/icon_pneu.jpg">
    <link rel="stylesheet" href="../static/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <title>Estoque</title>
</head>

<body>
    <header>
        <nav>
            <div class="nav__header">
                <div class="nav__logo">
                    <a href="/index"><img src="../static/images/logo-moto.png" alt="logo-moto" class="logo"></a>
                </div>
                <div class="nav__menu__btn" id="menu-btn">
                    <i class="ri-menu-line"></i>
                </div>
            </div>
            <ul class="nav__links" id="nav-links">
                <li><a href="/index#Inicio">INICIO</a></li>
                <li><a href="/index#sobre">SOBRE</a></li>
                <li><a href="/estoque">ESTOQUE</a></li>
            </ul>
            <div class="nav__btns">
            </div>
        </nav>
    </header>

    <div class="section__container estoque__container">
        <div class="estoque__header">
            <h1>Estoque de Produtos</h1>
            <div class="estoque__actions">
                <form action="{{ url_for('pesquisar_estoque') }}" method="GET" class="search-form">
                    <div class="InputContainer">
                        <input placeholder="Pesquisar" id="inputPesquisa" class="input" name="termo_pesquisa"
                            type="text" />
                        <label class="labelforsearch" for="inputPesquisa">
                            <svg class="searchIcon" viewBox="0 0 512 512">
                                <path
                                    d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z">
                                </path>
                            </svg>
                        </label>
                    </div>
                    <button type="submit" style="display: none;"></button>
                </form>                
                <a onclick="openModal()" class="button-adicionar">Adicionar Novo Produto</a>

                <div id="iframeModal" class="modal">
                    <div class="modal-content">
                        <button onclick="closeModal()" class="close-button"><i class="fas fa-times"></i></button>
                        <p class="form-title">Adicionar Produto</p>
                        <form action="{{ url_for('salvar_produto') }}" method="POST">
                            <div>
                                <label for="id_produto">ID Produto:</label>
                                <input type="number" id="id_produto" name="id_produto" required>
                            </div>
                            <div>
                                <label for="marca">Marca:</label>
                                <input type="text" id="marca" name="marca" required>
                            </div>
                            <div class="full-width">
                                <label for="nome">Nome:</label>
                                <input type="text" id="nome" name="nome" required>
                            </div>
                            <div>
                                <label for="modelo">Modelo:</label>
                                <input type="text" id="modelo" name="modelo" required>
                            </div>
                            <div>
                                <label for="medida">Medida:</label>
                                <input type="text" id="medida" name="medida">
                            </div>
                            <div>
                                <label for="tipo">Tipo:</label>
                                <input type="text" id="tipo" name="tipo">
                            </div>
                            <div>
                                <label for="qnt_atual">Quantidade Atual:</label>
                                <input type="number" id="qnt_atual" name="qnt_atual" value="0" required>
                            </div>
                            <div>
                                <label for="qnt_min">Quantidade Mínima:</label>
                                <input type="number" id="qnt_min" name="qnt_min" value="0">
                            </div>
                            <div>
                                <label for="qnt_repor">Quantidade a Repor:</label>
                                <input type="number" id="qnt_repor" name="qnt_repor" value="0">
                            </div>
                            <div>
                                <label for="valor_custo">Valor de Custo:</label>
                                <input type="number" step="0.01" id="valor_custo" name="valor_custo" value="0.00">
                            </div>
                            <div>
                                <label for="valor_venda">Valor de Venda:</label>
                                <input type="number" step="0.01" id="valor_venda" name="valor_venda" required>
                            </div>
                            <div class="form-buttons">
                                <button type="submit">Salvar Produto</button>
                                <a onclick="closeModal()" class="cancel-button">Cancelar</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        {% if mensagem %}
        <div class="mensagem-sucesso">
            {{ mensagem }}
        </div>
        {% endif %}
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nome</th>
                    <th>Marca</th>
                    <th>Modelo</th>
                    <th>Medida</th>
                    <th>Tipo</th>
                    <th>Qtd. Atual</th>
                    <th>Qtd. Mínima</th>
                    <th>Qtd. Repor</th>
                    <th>Valor Custo</th>
                    <th>Valor Venda</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for produto in produtos %}
                <tr>
                    <td>{{ produto[0] }}</td>
                    <td>{{ produto[1] }}</td>
                    <td>{{ produto[2] }}</td>
                    <td>{{ produto[3] }}</td>
                    <td>{{ produto[4] }}</td>
                    <td>{{ produto[5] }}</td>
                    <td>{{ produto[6] }}</td>
                    <td>{{ produto[7] }}</td>
                    <td>{{ produto[8] }}</td>
                    <td>{{ produto[9] }}</td>
                    <td>{{ produto[10] }}</td>
                    <td>
                        <a onclick="openModalEdit()">Editar</a>
                        <a href="#" onclick="confirmarExclusao({{ produto[0] }})">Excluir</a>
                    </td>
                </tr>
                <div id="iframeModalEdit" class="modal">
                    <div class="modal-content">
                        <button onclick="closeModalEdit()" class="close-button"><i class="fas fa-times"></i></button>
                        <p class="form-title">Editar Produto</p>                
                        <form action="{{ url_for('atualizar_produto', id_produto=produto[0]) }}" method="POST">
                            <div>
                                <label for="nome">Nome:</label>
                                <input type="text" id="nome" name="nome" value="{{ produto[1] }}" required>
                            </div>
                            <div>
                                <label for="marca">Marca:</label>
                                <input type="text" id="marca" name="marca" value="{{ produto[2] }}" required>
                            </div>
                            <div>
                                <label for="modelo">Modelo:</label>
                                <input type="text" id="modelo" name="modelo" value="{{ produto[3] }}" required>
                            </div>
                            <div>
                                <label for="medida">Medida:</label>
                                <input type="text" id="medida" name="medida" value="{{ produto[4] }}">
                            </div>
                            <div>
                                <label for="tipo">Tipo:</label>
                                <input type="text" id="tipo" name="tipo" value="{{ produto[5] }}">
                            </div>
                            <div>
                                <label for="qnt_atual">Quantidade Atual:</label>
                                <input type="number" id="qnt_atual" name="qnt_atual" value="{{ produto[6] }}" required>
                            </div>
                            <div>
                                <label for="qnt_min">Quantidade Mínima:</label>
                                <input type="number" id="qnt_min" name="qnt_min" value="{{ produto[7] }}">
                            </div>
                            <div>
                                <label for="qnt_repor">Quantidade a Repor:</label>
                                <input type="number" id="qnt_repor" name="qnt_repor" value="{{ produto[8] }}">
                            </div>
                            <div>
                                <label for="valor_custo">Valor de Custo:</label>
                                <input type="number" step="0.01" id="valor_custo" name="valor_custo" value="{{ produto[9] }}">
                            </div>
                            <div>
                                <label for="valor_venda">Valor de Venda:</label>
                                <input type="number" step="0.01" id="valor_venda" name="valor_venda" value="{{ produto[10] }}" required>
                            </div>
                            <button type="submit">Salvar Alterações</button>
                            <a href="{{ url_for('estoque') }}">Cancelar</a>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <script src="https://unpkg.com/scrollreveal"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="../static/main.js"></script>
    <script>
        function openModal() {
            document.getElementById("iframeModal").style.display = "flex";
        }
        function closeModal() {
            document.getElementById("iframeModal").style.display = "none";
        }
    </script>
    <script>
        function openModalEdit() {
            document.getElementById("iframeModalEdit").style.display = "flex";
        }
        function closeModalEdit() {
            document.getElementById("iframeModalEdit").style.display = "none";
        }
    </script>
</body>

</html>